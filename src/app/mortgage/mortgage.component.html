<div class="page ai-style">
    <header class="hero">
        <div class="hero-bg-blob" aria-hidden="true">
            <!-- decorative gradient blob -->
            <svg viewBox="0 0 600 400" preserveAspectRatio="none">
                <defs>
                    <linearGradient id="g1" x1="0" x2="1">
                        <stop offset="0" stop-color="#6ee7b7"/>
                        <stop offset="1" stop-color="#60a5fa"/>
                    </linearGradient>
                </defs>
                <path d="M421.5,56.2C478.3,99.5,488,184.9,455.8,238.9C423.6,292.9,350.4,315.4,290.6,344.5C230.7,373.7,183.2,409.4,121.4,392.9C59.6,376.4,23.5,307.6,12.5,243.9C1.6,180.2,15.9,121.5,67.7,83.9C119.5,46.4,209.7,30.1,281.6,32.4C353.4,34.7,364.8,12.9,421.5,56.2Z" fill="url(#g1)"/>
            </svg>
        </div>

        <div class="hero-content">
            <div class="hero-left">
                <div class="ai-badge">
                    <div class="ai-icon">
                        <svg viewBox="0 0 24 24" width="36" height="36" aria-hidden="true">
                            <rect x="3" y="7" width="18" height="12" rx="3" fill="#fff1"/>
                            <circle cx="9" cy="12" r="1.5" fill="#fff"/>
                            <circle cx="15" cy="12" r="1.5" fill="#fff"/>
                            <rect x="8" y="3" width="8" height="3" rx="1.2" fill="#fff"/>
                        </svg>
                    </div>
                    <div class="ai-texts">
                        <div class="ai-title">AI Mortgage Assistant</div>
                        <div class="ai-sub">Personalized tips · Quick presets</div>
                    </div>
                    <span class="pill">NEW</span>
                </div>

                <h1 class="title">US Mortgage Calculator</h1>
                <p class="subtitle">
                    Smart monthly estimates with PMI, taxes & insurance. Get tips to lower payments.
                </p>

                <div class="hero-actions">
                    <button class="cta" (click)="calculateMortgage()">Calculate now</button>
                    <button class="ghost" (click)="homePrice = 500000">Try sample $500k</button>
                </div>
            </div>

            <div class="hero-right">
                <div class="card-tip">
                    <h4>AI Tip</h4>
                    <p><strong>Boosting your down payment</strong> to 20% often removes PMI — try the preset to see impact instantly.</p>
                    <div class="quick-stats">
                        <div><strong>{{ (downPayment / homePrice * 100) | number:'1.0-0' }}%</strong><span> Equity</span></div>
                        <div><strong>{{ loanTerm }}</strong><span> Years</span></div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="layout">
        <!-- INPUT CARD -->
        <div class="card inputs">
            <h2>Loan Details</h2>

            <div class="field">
                <label>Home Price ($)</label>
                <div class="control">
                    <input class="text" type="number" [(ngModel)]="homePrice" title="Enter home price">
                    <input class="range"
                           type="range"
                           min="50000"
                           max="2000000"
                           step="5000"
                           [(ngModel)]="homePrice"
                           [style.background]="getRangeBackground(homePrice, 50000, 2000000)">
                </div>
            </div>

            <div class="field">
                <label>Down Payment ($)</label>
                <div class="control">
                    <input class="text" type="number" [(ngModel)]="downPayment" [disabled]="downPayment > homePrice" title="Enter down payment">
                    <input class="range"
                           type="range"
                           min="0"
                           [max]="homePrice"
                           step="1000"
                           [(ngModel)]="downPayment"
                           [style.background]="getRangeBackground(downPayment, 0, (homePrice || 1))"
                           [disabled]="downPayment > homePrice">
                </div>
                <small class="error" *ngIf="downPayment > homePrice">Down payment must be less than home price</small>
            </div>

            <div class="row">
                <div class="field">
                    <label>Interest Rate (%)</label>
                    <div class="control">
                        <input class="text" type="number" step="0.01" [(ngModel)]="interestRate">
                        <input class="range"
                               type="range"
                               min="2"
                               max="15"
                               step="0.05"
                               [(ngModel)]="interestRate"
                               [style.background]="getRangeBackground(interestRate, 2, 15)">
                    </div>
                </div>

                <div class="field">
                    <label>Loan Term (Years)</label>

                    <!-- New segmented control + compact numeric input -->
                    <div class="segmented" role="tablist" aria-label="Loan term">
                        <button type="button" class="seg-btn" [class.active]="loanTerm === 15" (click)="loanTerm = 15">15 yrs</button>
                        <button type="button" class="seg-btn" [class.active]="loanTerm === 20" (click)="loanTerm = 20">20 yrs</button>
                        <button type="button" class="seg-btn" [class.active]="loanTerm === 30" (click)="loanTerm = 30">30 yrs</button>

                        <!-- small numeric input for custom terms -->
                        <div class="seg-input" title="Enter custom years">
                            <input class="text small" type="number" min="5" max="40" [(ngModel)]="loanTerm">
                            <span class="seg-suffix">yrs</span>
                        </div>
                    </div>

                    <!-- keep native select for form/legacy (visually hidden) -->
                    <select class="visually-hidden" [(ngModel)]="loanTerm" aria-hidden="true">
                        <option [value]="15">15 Years</option>
                        <option [value]="20">20 Years</option>
                        <option [value]="30">30 Years</option>
                    </select>
                </div>
            </div>

            <div class="row">
                <div class="field">
                    <label>Property Tax (%)</label>
                    <input class="text" type="number" step="0.1" [(ngModel)]="propertyTaxRate">
                </div>

                <div class="field">
                    <label>Insurance (Yearly $)</label>
                    <input class="text" type="number" [(ngModel)]="insurancePerYear">
                </div>
            </div>

            <div class="presets">
                <small>Quick presets</small>
                <div class="chips">
                    <button class="chip" type="button" (click)="homePrice = 250000">Starter $250k</button>
                    <button class="chip" type="button" (click)="homePrice = 500000">Family $500k</button>
                    <button class="chip" type="button" (click)="homePrice = 1000000">Luxury $1M</button>
                </div>
            </div>

            <button class="primary-btn" (click)="calculateMortgage()">
                Calculate Mortgage
            </button>
        </div>

        <!-- RESULTS CARD -->
        <div class="card result" *ngIf="totalMonthlyCost">
            <div class="result-top">
                <h2>Your Monthly Cost</h2>
                <div class="ai-signal">AI insight: <span class="muted">PMI included if down payment &lt; 20%</span></div>
            </div>

            <div class="big-number">
                ${{ totalMonthlyCost | number:'1.0-0' }}
            </div>

            <div class="breakdown">
                <div>
                    <span>Mortgage</span>
                    <span class="value">${{ monthlyPayment | number:'1.0-0' }}</span>
                </div>
                <div>
                    <span>Property Tax</span>
                    <span class="value">${{ (homePrice * propertyTaxRate / 100 / 12) | number:'1.0-0' }}</span>
                </div>
                <div>
                    <span>Insurance</span>
                    <span class="value">${{ insurancePerYear / 12 | number:'1.0-0' }}</span>
                </div>

                <!-- NEW: total interest over selected years -->
                <div>
                    <span>Total interest ({{ loanTerm }} yrs)</span>
                    <span class="value">${{ totalInterest | number:'1.0-0' }}</span>
                </div>
            </div>

            <p class="note">
                * PMI included automatically if down payment is below 20%.
            </p>
        </div>
    </div>
</div>