<div class="page ai-style">
  <header class="hero">
    <div class="hero-bg-blob" aria-hidden="true">
      <!-- decorative gradient blob -->
      <svg viewBox="0 0 600 400" preserveAspectRatio="none">
        <defs>
          <linearGradient id="g1" x1="0" x2="1">
            <stop offset="0" stop-color="#6ee7b7"/>
            <stop offset="1" stop-color="#60a5fa"/>
          </linearGradient>
        </defs>
        <path d="M421.5,56.2C478.3,99.5,488,184.9,455.8,238.9C423.6,292.9,350.4,315.4,290.6,344.5C230.7,373.7,183.2,409.4,121.4,392.9C59.6,376.4,23.5,307.6,12.5,243.9C1.6,180.2,15.9,121.5,67.7,83.9C119.5,46.4,209.7,30.1,281.6,32.4C353.4,34.7,364.8,12.9,421.5,56.2Z" fill="url(#g1)"/>
      </svg>
    </div>

    <div class="hero-content">
      <div class="hero-left">
        <h1 class="title">Mortgage Calculator</h1>
        <p class="subtitle">
          Smart monthly estimates with PMI, taxes & insurance. Get tips to lower payments.
        </p>

        <div class="hero-actions">
          <button class="cta" (click)="calculateMortgage()">Calculate now</button>
          <button class="ghost" (click)="homePrice = 500000">Try sample $500k</button>
        </div>
      </div>
    </div>
  </header>

  <div class="layout">
    <!-- INPUT CARD -->
    <div class="card inputs">
      <h2>Loan Details</h2>

      <div class="field">
        <label>Home Price ($)</label>
        <div class="control">
          <input class="text" type="number" [(ngModel)]="homePrice" title="Enter home price">
          <input class="range"
            type="range"
            min="50000"
            max="2000000"
            step="5000"
            [(ngModel)]="homePrice"
            [style.background]="getRangeBackground(homePrice, 50000, 2000000)">
        </div>
      </div>

      <div class="field">
        <label>Down Payment ($)</label>
        <div class="control">
          <input class="text" type="number" [(ngModel)]="downPayment" [disabled]="downPayment > homePrice" title="Enter down payment">
          <input class="range"
            type="range"
            min="0"
            [max]="homePrice"
            step="1000"
            [(ngModel)]="downPayment"
            [style.background]="getRangeBackground(downPayment, 0, (homePrice || 1))"
            [disabled]="downPayment > homePrice">
        </div>
        @if (downPayment > homePrice) {
          <small class="error">Down payment must be less than home price</small>
        }
      </div>

      <div class="row">
        <div class="field">
          <label>Interest Rate (%)</label>
          <div class="control">
            <input class="text" type="number" step="0.01" [(ngModel)]="interestRate">
            <input class="range"
              type="range"
              min="2"
              max="15"
              step="0.05"
              [(ngModel)]="interestRate"
              [style.background]="getRangeBackground(interestRate, 2, 15)">
          </div>
        </div>

        <div class="field">
          <label>Loan Term (Years)</label>
          <div class="control">
            <input class="text" type="number" min="5" max="40" [(ngModel)]="loanTerm">
            <input class="range"
              type="range"
              min="5"
              max="40"
              step="1"
              [(ngModel)]="loanTerm"
              [style.background]="getRangeBackground(loanTerm, 5, 40)">
          </div>
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Property Tax (%)</label>
          <input class="text" type="number" step="0.1" [(ngModel)]="propertyTaxRate">
        </div>

        <div class="field">
          <label>Insurance (Yearly $)</label>
          <input class="text" type="number" [(ngModel)]="insurancePerYear">
        </div>
      </div>

      <div class="presets">
        <small>Quick presets</small>
        <div class="chips">
          <button class="chip" type="button" (click)="homePrice = 250000">
            <svg class="chip-icon" viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
              <path d="M3 13h2v8H3zm4-8h2v16H7zm4-2h2v18h-2zm4 4h2v14h-2zm4-4h2v18h-2z" fill="currentColor"/>
            </svg>
            Starter $250k
          </button>
          <button class="chip" type="button" (click)="homePrice = 500000">
            <svg class="chip-icon" viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="currentColor"/>
            </svg>
            Family $500k
          </button>
          <button class="chip" type="button" (click)="homePrice = 1000000">
            <svg class="chip-icon" viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="currentColor"/>
            </svg>
            Luxury $1M
          </button>
        </div>
      </div>

      <button class="primary-btn" (click)="calculateMortgage()">
        Calculate Mortgage
      </button>
    </div>

    <!-- RESULTS CARD -->
    @if (totalMonthlyCost) {
      <div class="card result">
        <div class="result-top">
          <h2>Your Monthly Cost</h2>
          <div class="ai-signal">AI insight: <span class="muted">PMI included if down payment &lt; 20%</span></div>
        </div>
        <div class="big-number">
          ${{ totalMonthlyCost | number:'1.0-0' }}
        </div>
        <div class="breakdown">
          <div class="mortgage">
            <span>Mortgage</span>
            <span class="value">${{ monthlyPayment | number:'1.0-0' }}</span>
          </div>
          <div class="mortgage">
            <span>Property Tax</span>
            <span class="value">${{ (homePrice * propertyTaxRate / 100 / 12) | number:'1.0-0' }}</span>
          </div>
          <div class="mortgage">
            <span>Insurance</span>
            <span class="value">${{ insurancePerYear / 12 | number:'1.0-0' }}</span>
          </div>
          <!-- NEW: total interest over selected years -->
          <div class="interest-highlight">
            <div class="interest-label">
              <svg class="warning-icon" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
                <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" fill="currentColor"/>
              </svg>
              <span>Total interest ({{ loanTerm }} yrs)</span>
            </div>
            <span class="value interest-value">${{ totalInterest | number:'1.0-0' }}</span>
          </div>
        </div>
        <p class="note">
          * PMI included automatically if down payment is below 20%.
        </p>
      </div>
    }
  </div>

  <footer class="footer-section">
    <div class="footer-content">
      <div class="ai-tip-footer">
        <h3>AI Tip</h3>
        <p><strong>Boosting your down payment to 20%</strong> often removes PMI â€” try the preset to see impact instantly.</p>
        <div class="tip-stats">
          <div><strong>20%</strong><span>Equity</span></div>
          <div><strong>{{ loanTerm }}</strong><span>Years</span></div>
        </div>
      </div>
    </div>
  </footer>
</div>